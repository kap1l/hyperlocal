"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.requestWidgetUpdate = requestWidgetUpdate;
var _AndroidWidget = require("../AndroidWidget");
var _buildWidgetTree = require("./build-widget-tree");
/**
 * Request widget update for a given widget name
 * A callback will be called for each widget with that name that is added to the home screen
 *
 * @param param0 {@link RequestWidgetUpdateProps}
 */
async function requestWidgetUpdate(_ref) {
  let {
    widgetName,
    renderWidget,
    widgetNotFound
  } = _ref;
  const widgetsInfo = await _AndroidWidget.AndroidWidget.getWidgetInfo(widgetName);
  if (widgetsInfo.length === 0) {
    widgetNotFound === null || widgetNotFound === void 0 ? void 0 : widgetNotFound();
  }
  widgetsInfo.forEach(async info => {
    const widgetComponent = await renderWidget(info);
    const lightWidget = 'light' in widgetComponent ? (0, _buildWidgetTree.buildWidgetTree)(widgetComponent.light) : (0, _buildWidgetTree.buildWidgetTree)(widgetComponent);
    const darkWidget = 'dark' in widgetComponent ? (0, _buildWidgetTree.buildWidgetTree)(widgetComponent.dark) : null;
    const config = {
      light: lightWidget,
      dark: darkWidget
    };
    _AndroidWidget.AndroidWidget.drawWidgetById(config, widgetName, info.widgetId);
  });
}
//# sourceMappingURL=request-widget-update.js.map